# Ultravox eval configuration
name: ultravox-eval
image: mosaicml/composer:latest
compute:
  gpus: 8
  cluster: r18z1p1
integrations:
  - integration_type: git_repo
    git_repo: fixie-ai/ultravox
    git_branch: main
scheduling:
  max_duration: 4  # 4 hours max for jobs to avoid hanging jobs
command: |
  cd ultravox &&
  source $VENV_PATH/bin/activate &&
  $POETRY_HOME/bin/poetry install --only main &&
  torchrun --nproc_per_node=8 -m ultravox.evaluation.eval $EVAL_ARGS
env_variables:
  EVAL_ARGS: --config_path ultravox/evaluation/configs/eval_config.yaml
  HF_HUB_ENABLE_HF_TRANSFER: 1
